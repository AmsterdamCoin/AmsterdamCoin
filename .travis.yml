language: csharp
mono: none
dotnet: 1.0.4
matrix:
  include:
  - os: linux # Ubuntu 14.04
    dist: trusty
    sudo: required      
  - os: osx # OSX 10.11
    osx_image: xcode7.3      
  - os: osx # OSX 10.12
    osx_image: xcode8.1      

# branches to build 
branches:
  only:
  - master

env:
  global: 
  - log_prefix="[$TRAVIS_OS_NAME]"
  - arch=x64
  - configuration="Release"
  - app_output_name="breeze-$arch-$TRAVIS_OS_NAME-Release"
  - api_output_name="api-$arch-$TRAVIS_OS_NAME-Release"
  - os_platform=linux
  - TRAVIS_TAG=cd-unstable

# Work around NuGet issue #2163
# https://github.com/NuGet/Home/issues/2163
# https://github.com/travis-ci/travis-ci/issues/7728
before_install:    
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then ulimit -n 1024 ; os_platform=darwin ; fi

install:
  - nvm install 6
script:
  - chmod +x build.sh
  - ./build.sh

deploy:
  provider: releases
  api_key: 
  - secure: f99l6mM8zgYWszfRnUFWtRMoxU+eF22J71UVsJ7IIy9v16atpM7s8GiE6mZX3ycKf8kz+cqNNtF2WKLxUJzW6maquK3sJf9i0zL0gmibjP1A8sBnfxPSHvrcSdEcJAX37htYL34IHaHikmY2BUVOROjinB5HIVwV0Itp4wUlAJLbjH9m4kSJ6jFp7QbzL/lI8KjtyZFoXyQhVK37PLZT0G3fzvY2iibr9hLBniiteVcIHUDnuuezhiea5ReYc4BGj3bEmKC3Cdteg/3KnyEfaXYuTOkPWKolXwEGMvUaTyJv7qkckT4UoLIMlmpNVxWMaADWLZw+JINGht0aZx0AGYLpy1sbI8DuAB5cddT+vI6+3BNlBOT6AFohOlehZgVXgPd8iWdA4t6WkxHUyD+/DhGA15fZMgM5vBS7rTqAsVEHuzyJjQx4N34Zp7+yeSQ027Ko3q1DQxU6glusCsgToKSAAZNlziwbReGYhTC6xWZy8+vmxA7Mn8ShR1zSYgjlZSl+nn9GJZQ/3Njs0dZMjhl94aw3ZKh954p10Kwuleb3iokIj8vzgr9vXWmWIZ62zzaLMF/0FIGhQ3LofR32ruXchRD831pGBAVIymkTtk83DICwuJD1kwCeBtEL9JclRTtWIAEE5FxfVmYD3I70SYxYP1uSoSWRdeiQw3uLV20=
  file_glob: true
  file: $TRAVIS_BUILD_DIR/deploy/*.zip
  skip_cleanup: true
  overwrite: true
  prerelease: true
  on:
    branch: master
    tags: true